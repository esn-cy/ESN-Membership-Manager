esn_membership_manager.scan:
  path: '/api/memberships/scan'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\ScanController::scanCard'
    _title: 'Scan Free Passes and ESNcards'
  requirements:
    _permission: 'scan cards'
  methods: [ POST ]
  options:
    _auth: [ 'oauth2', 'cookie' ]

esn_membership_manager.add:
  path: '/api/memberships/add'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\AddController::addCard'
    _title: 'Add ESNcard'
  requirements:
    _permission: 'manage esncard numbers'
  methods: [ POST ]
  options:
    _auth: [ 'oauth2', 'cookie' ]

esn_membership_manager.status:
  path: '/api/memberships/status'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\StatusController::changeStatus'
    _title: 'Change the status of an ESNcard'
  requirements:
    _access: 'TRUE'
  methods: [ POST ]
  options:
    _auth: [ 'oauth2', 'cookie' ]

esn_membership_manager.edit:
  path: '/api/memberships/edit'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\EditController::editApplication'
    _title: 'Edit Application'
  requirements:
    _permission: 'edit submission'
  methods: [ POST ]
  options:
    _auth: [ 'oauth2', 'cookie' ]

esn_membership_manager.online:
  path: '/api/memberships/online'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\OnlineController::checkOnlineStatus'
  requirements:
    _access: 'TRUE'
  methods: [ GET ]

esn_membership_manager.stripe_webhook:
  path: '/stripe/webhook'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\StripeWebhookController::handleWebhook'
  requirements:
    _access: 'TRUE'
  methods: [ POST ]

esn_membership_manager.apply:
  path: '/memberships/apply'
  defaults:
    _form: '\Drupal\esn_membership_manager\Form\ApplicationForm'
    _title: 'Membership Registration'
  requirements:
    _access: 'TRUE'

esn_membership_manager.apply_success:
  path: '/memberships/apply/success'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\SubmissionController::successPage'
    _title: 'Application Received'
  requirements:
    _access: 'TRUE'

esn_membership_manager.submissions:
  path: '/memberships/submissions'
  defaults:
    _form: '\Drupal\esn_membership_manager\Form\SubmissionsForm'
    _title: 'Application Submissions'
  requirements:
    _permission: 'view submissions'

esn_membership_manager.scan_page:
  path: '/memberships/scan'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Page\ScanPage::scanPage'
    _title: 'Scan Free Passes and ESNcards'
  requirements:
    _permission: 'scan cards'

esn_membership_manager.manage_esncard_numbers:
  path: '/memberships/manage-esncard-numbers'
  defaults:
    _form: '\Drupal\esn_membership_manager\Form\ESNcardNumberForm'
    _title: 'Bulk Insert ESNcards'
  requirements:
    _permission: 'manage esncard numbers'
  options:
    _admin_route: FALSE

esn_membership_manager.settings:
  path: '/admin/config/system/esn-membership-manager'
  defaults:
    _form: '\Drupal\esn_membership_manager\Form\SettingsForm'
    _title: 'ESN Membership Manager Settings'
  requirements:
    _permission: 'manage module settings'

esn_membership_manager.weeztix_oauth_callback:
  path: '/admin/config/system/esn-membership-manager/weeztix-auth-callback'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\WeeztixAuthController::callback'
    _title: 'Weeztix Authentication'
  requirements:
    _permission: 'manage module settings'

esn_membership_manager.file_download:
  path: '/memberships/files/{application_id}/{filename}'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\FileAccessController::download'
    _title: 'Download File'
  requirements:
    _access: 'TRUE'
    application_id: \d+|temp_uploads
    filename: .+
  options:
    parameters:
      application_id:
        type: string
      filename:
        type: string

esn_membership_manager.file_preview:
  path: '/memberships/files/{file}/preview'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\SubmissionController::preview'
    _title: 'File Preview'
  requirements:
    _permission: 'view submissions'
  options:
    parameters:
      file:
        type: entity:file

esn_membership_manager.submission_view:
  path: '/memberships/submissions/{id}/view'
  defaults:
    _controller: '\Drupal\esn_membership_manager\Controller\SubmissionController::viewSubmission'
    _title: 'View Submission'
  requirements:
    _permission: 'view submissions'
  methods: [ GET, POST ]